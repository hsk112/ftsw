<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>通讯录</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <link href="../../../css/common.css" rel="stylesheet" />
  <link href="../../../css/mui.min.css" rel="stylesheet" />
  <link href="../../../css/mui.picker.min.css" rel="stylesheet" />
  <link href="../../../css/mui.poppicker.css" rel="stylesheet" />
  <style>
    .mui-col-xs-6 {
      text-align: left;
    }
    .mui-table-view-cell.mui-collapse.mui-active .arrow_right{
      transform: rotate(90deg);
      margin-left: 5px;
    }
    .mui-control-content .mui-loading {
      margin-top: 50px;
    }

    .mui-table-view-cell.mui-collapse.mui-active + .www .arrow_right {
      transform: rotate(90deg);
      margin-left: 5px;
    }


    .mui-table-view-cell>a:not(.mui-btn){
      margin: 0;
      padding:10px;
    }
    /*.mui-table-view-cell div{*/
    /*  margin-bottom: 10px;*/
    /*}*/

    .mui-table-view-cell .item-first {
      display: flex;
      font-size: 16px;
      color: #191515;
      margin-top: 10px
    }
    .mui-page-content {
      background: #F4F4F4;
    }

    .mui-table-view {
      background-color: #F4F4F4;
      text-align: left;
    }

    .fanwei{
      white-space: nowrap;
      display: inline-block;
      width: 280px;
      margin-left: 0px;
      overflow: hidden;
      text-overflow: ellipsis;
      text-align: left
    }


    .object{
      display: flex;
      justify-content: space-between;
      margin: 8px 0;
    }

    .in-obj{
      font-weight: 400;
      color: #888888;
      margin-right: 7px;
    }
    .obj-title{
      color: #444444;
    }
    .bgc-white{
      background-color: white;
    }
    .bgc-grey{
      background-color: #F4F4F4;
    }
    .mui-navigate-r{
      background: #fff;
    }
    .icon-css{
      display: inline-block;
      padding: 8px 0 0;
      vertical-align: top;
    }
    .task_title{
      display: inline-block;
      padding: 8px 0;
      color: #191515;
      font-size: 15px;
      font-weight: 500;
      width: 50%;
      word-break: break-all;
      white-space: pre-wrap;
    }
    .sec-line{
      color: #878787;
      font-size: 14px;
    }
    /* 	.arrow_right{
      transform: rotate(90deg);
    } */
    .ul-mar-bottom{
      margin-bottom: -18px;
    }


    .color888{
      color: #888888;
    }
    .ibh{
      display: inline-block;
      line-height: 28px;
    }
    .no-data {
      position: absolute;
      top: 10rem;
      left: 50%;
      display: inline-block;
      font-size: 20px;
      color: #999;
      transform: translateX(-50%);
    }
    .showMore{
      display: inline-block;
    }

    #listTitle span{
      padding: 0;
      color: #888888;
    }

    #listTitle{
      width: 100%;
      height: 40px;
      padding-left: 20px;
      line-height: 40px;
      background: #F0F0F0;
    }


    #selectDistrict_ul span, #selectStreet_ul span, #selectCommunity_ul span,
    #selectLakeDistrict_ul span, #selectLakeStreet_ul span, #selectLakeCommunity_ul span{
      padding: 0;
    }

    /*.mui-table-view-cell:after{*/
    /*  left: 4%;*/
    /*  height: 2px;*/
    /*  width: 92%;*/
    /*}*/

    .home-item {
      position: fixed;
      width: 100%;
      z-index: 999;
      top: 0;
      left: 0;
      height: 300px;
      background: #FFFFFF
    }

    .home-item-title {
      font-size: 19px;
      width: 100%;
      height: 20px;
      text-align: left;
      padding: 25px 23px;
      color: #191515;
      font-weight: bold;
    }

    .home-item-title .span-bg {
      width: 78px;
      height: 12px;
      background: rgba(219, 232, 255, 1);
      margin-top: -10px;
    }


    .home-item-list {
      width: 100%;
      margin-top: 23px;
      height: 77px;
      /* height: 107px; */
    }

    .home-item-list .item {
      width: 25%;
      float: left;
      text-align: center;
      font-size: 13px;
      margin-bottom: 24px;
      /* border-bottom: 2px solid #EEEEEE; */

    }

    .home-item-list .item img {
      height: 40px;
      width: 40px;
      border-radius: 40px;
      margin: 0 auto;
      display: block;
      margin-bottom: 10px;
    }

    .home-item-list .item img {
      height: 40px;
      width: 40px;
      border-radius: 40px;
      margin: 0 auto;
      display: block;
      margin-bottom: 10px;
    }

    #search_input1,#search_input2,#search_input3{
      margin: 0;
      width: 90%;
      height: 32px;
      border-radius: 16px;
      border: none;
      padding-left: 35px;
    }

    #search{
      padding: 10px 0;
      background: #F4F4F4;
      /*border-bottom: 7px solid #F4F4F4;*/
      position: relative;
    }


    #search_icon img{
      width: 14px;
      height: 14px;
      position: absolute;
      left: 9%;
      top: 30%;
    }

    #del_icon1 img, #del_icon2 img, #del_icon3 img {
      width: 14px;
      height: 14px;
      position: absolute;
      right: 9%;
      top: 33%;
    }

    .btn-outlined{
      border:1px solid #337BFC;
      color: #337BFC;
    }
    .mui-btn.mui-active:enabled{
      background: #337BFC;
    }

    #foldTitle{
      height: 40px;
      line-height: 40px;
      background: #F0F0F0;
    }

    #whichRiver{
      padding-left: 20px;
      background-color: #FFFFFF;
      height: 40px;
      line-height: 40px;
      color: #191515;
      display: none;
    }

    #whichRiver span{
      padding: 0;
    }

    #whichLake{
      padding-left: 20px;
      background-color: #FFFFFF;
      height: 40px;
      line-height: 40px;
      color: #191515;
      display: none;
    }

    #whichLake span{
      padding: 0;
    }

    #highest {
      height: 50px;
      line-height: 50px;
    }

    #leader {
      height: 50px;
      line-height: 50px;
    }

    #details{
      margin: 0 20px;
    }

    #viewMore{
      border-top: 5px solid #F4F4F4;
      display: flex;
      align-items: center;
      color: #337BFC;
      height: 40px;
      padding-left: 20px;
    }

    #viewLakeMore{
      border-top: 5px solid #F4F4F4;
      display: flex;
      align-items: center;
      color: #337BFC;
      height: 40px;
      padding-left: 20px;
    }

    *{
      touch-action: none;
    }

  /* 自定义的样式 */
    .mui-page {
      background-color: #ffffff;
    }
    .mui-table-view:before
    {
      background-color: white;
    }
    .mui-table-view:after
    {
      background-color: white;
    }
    .mui-table-view-cell{
      font-size: 16px;
      color: #191515;

      /*margin-left: 20px;*/
      line-height: 40px;
      background-color: #FFFFFF;
    }
    .mui-table-view-cell.mui-active {
      background-color: #FFFFFF;
    }
    .mui-table-view-cell:after{
      left:10px;
      right: 10px;
      background-color: #F4F4F4;
      height: 1px;
    }
    .view-content-item {
      display: flex;line-height: 53.5px;
    }
    .item-right-object {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 40px;
      width: 40px;
    }
    .item-right-object .img-phone {
      width: 16px; height: 20px;
    }
    .item-right-object .img-right-arrow {
      width: 11px; height: 17px;
    }
    .itemContentMargin {
      margin-left: 10px;
    }

    .person-img-item {
      width:36px;
      height: 36px;
    }

  </style>
</head>

<body>
<!--页面主结构开始-->
<div id="app" class="mui-views">
  <div class="mui-view">
    <div class="mui-navbar">
    </div>
    <div class="mui-pages">
    </div>
  </div>
</div>
<div class="home-item" style="display: none;" id="home-item">
  <div class="home-item-list" id="business_item">
    <div class="item" id="missionUncompleted">
      <img src="../../../img/missionUncompleted.png">
      <span>待办任务</span>
    </div>
    <div class="item" id="notification">
      <img src="../../../img/notification.png">
      <span>通知公告</span>
    </div>
    <div class="item" id="directory">
      <img src="../../../img/directory.png">
      <span>通讯录</span>
    </div>

    </div>
  </div>
</div>

<!--页面主结构结束-->
<!--单页面开始-->
<div id="mui-content" class="mui-page">
  <!--页面标题栏开始-->
  <!--页面标题栏结束-->
  <!--页面主内容区开始-->
  <div class="mui-page-content">
    <div class="mui-scroll-wrapper">
      <div class="mui-scroll">
          <div id="scroll1" class="mui-scroll-wrapper" style="overflow-y: scroll;height: 100vh; padding-bottom:50px">

            <div class="view-content-item" >
              <div id="content" style="width: 100%;overflow-y: scroll;background-color: #F4F4F4;">
                <!-- 用户头像 、名称 start -->
                <div class="mui-table-view" style="margin-bottom: 5px;">
                  <div class="mui-table-view-cell mui-media">
                    <!-- 左边图 -->
<!--                    <img src="../../../img/address-book-icon.png" style="width:36px; height: 36px;"-->
<!--                         class="mui-media-object mui-pull-left" />-->
                    <div class="mui-media-object mui-pull-left" id="person-photo" style="margin-right: 0;">
<!--                       address-book-icon.png -->
                      <img id="userImage" style="display: none;" class="person-img-item" src="../../../img/user.png" />
                    </div>
                    <!-- 右边图 -->
                    <div class="mui-pull-right" style="display: none;" >
                        <div style="display: flex;align-items: center">
                          <img src="../../../img/offline-gray.png"
                               style="width:12px; height: 12px;margin-right: 5px;"/>
                          已离线
                        </div>
                    </div>

                    <div class="mui-media-body" id="person-name">

                    </div>

                  </div>
                </div>
                <!-- 用户头像 、名称 end -->
                <ul class="mui-table-view">
                  <li class="mui-table-view-cell ">
                    <div class="mui-pull-right" >
                      <div class="item-right-object" id="phone-blue-icon">
                        <img class="img-phone" src="../../../img/phone-blue.png"/>
                      </div>
                    </div>
                    <div>
                      手机
                      <span class="itemContentMargin" >
                      <a href="#" id="mobile"></a>
                      </span>
                    </div>

                  </li>
                  <li class="mui-table-view-cell ">
                    <div>
                      座机 <span class="itemContentMargin" id="tel"></span>
                    </div>

                  </li>
                  <li class="mui-table-view-cell">
                    <div>
                      邮箱 <span class="itemContentMargin" id="email"></span>
                    </div>
                  </li>
                  <li class="mui-table-view-cell">
                    <div class="mui-pull-right" style="display: none;">
                      <div class="item-right-object">
                        <img class="img-right-arrow" src="../../../img/arrow-right-gray.png"/>
                      </div>
                    </div>
                    <div>
                      部门 <span class="itemContentMargin" id="department"> </span>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
      </div>
    </div>
  </div>
  <!--页面主内容区结束-->
</div>
</body>

<script src="../../../js/jquery.min.js"></script>
<script src="../../../js/mui.min.js"></script>
<script src="../../../js/mui.view.js"></script>
<script src="../../../js/mui.locker.js"></script>
<script src="../../../js/common.js"></script>
<script src="../../../js/app.js"></script>
<script src="../../../js/config.js"></script>
<script src="../../../js/maintain.js"></script>
<script src="../../../js/s4.js"></script>
<script src="../../../js/smutils.js"></script>
<script src="../../../js/byte&string.js"></script>
<script src="../../../js/ajaxhook.min.js"></script>
<script src="../../../js/mui.picker.min.js"></script>
<script src="../../../js/mui.picker.js"></script>
<script src="../../../js/mui.poppicker.js"></script>
<!-- <script src="../../js/timer.js"></script> -->
<!-- <script src="../../../js/vconsole.min.js"></script> -->

<script src="../../../js/infoQuery/leaderList.js"></script>
<script src="../../../js/workSpace/addressBook.js"></script>
<!--<script src="../../../js/workSpace/conservation.js"></script>-->

<script>

  var isTest = false

    mui.init({
        swipeBack: false
    });
    // // 与列表是同一个接口 ，参数不一样： companyId 、personCode、username
    let param = {
      perId: ""
      // ,companyId: "", //"100000060",
      // personCode: "", // "202102241041",
      // username: "" //"luo_yb"
    }
    // var vConsole = new VConsole();
    mui.back = function() {
        var curr = plus.webview.currentWebview();
        // var wvs = plus.webview.all();
        // for (var i = 0, len = wvs.length-1; i < len; i++) {
        //     let theurl = wvs[i].getURL() + '';
        //     if (!(theurl.search('login.html') != -1 ||
        //         theurl.search('www/main.html') != -1 ||
        //         theurl.search('www/index.html') != -1 ||
        //         theurl.search('/searchInfo/index.html') != -1)){
        //         wvs[i].close('none');
        //     }
        // }
        curr.close('slide-out-right');
    }

    var riverData = [];
    var lakeData = [];
    var isOpen = false;
    var isLakeOpen = false;
    var isShow = true;
    var riverPageNo = '1';
    var riverPageSize = '100';
    var lakePageNo = '1';
    var lakePageSize = '100';
    var userPicker = new mui.PopPicker();
    var searchRiver = [];
    var searchLake = [];
    var riverList = [];
    var lakeList = [];
    var riverResultJSON = [];
    var lakeResultJSON = [];

    var mask = mui.createMask();

    //初始化单页view
    var viewApi = mui('#app').view({
        defaultPage: '#mui-content'
    });
    //初始化单页的区域滚动
    mui('.mui-scroll-wrapper').scroll();
    var pickerpxtop = null;

    var extras = {
        openNum: 0
    }

    var input1 = document.getElementById("search_input1");
    var input2 = document.getElementById("search_input2");
    var input3 = document.getElementById("search_input3");

    mui.plusReady(function() {

        $("#del_icon1").hide();
        $("#del_icon2").hide();
        $("#del_icon3").hide();
        // initSelected();
        // 初始化数据列表（河流数据）
        //禁止选项卡自带滑动
        // mui('.mui-slider').slider().stopped = true;
        var self = plus.webview.currentWebview();
        extras.openNum = self.openNum + 1; //初始化打开页面数量

        param.perId = self.nid; //JSON.stringify(self.nid);
         console.log('id:'+param.perId)

      // 请求数据
      getAddressBookDetailFun(false);

        self.setStyle({
            titleNView: {
                backgroundImage: "../../../img/bgTopClear.png",
                backgroundRepeat: 'no-repeat',
                buttons: [{
                    float: 'right',
                    width: '70',
                    fontSize: '17',
                    text: '',
                    onclick: function() {
                        // if (isShow) {
                        //     isShow = false;
                        //     $("#home-item").show();
                        //     mask.show()
                        // } else {
                        //     isShow = true;
                        //     $('#home-item').hide();
                        //     mask.close();
                        // }
                    }
                }],
            }
        });
      var winHeight = window.screen.height-135;
      $("#content").css("height",winHeight+"px");

      // var html =''
      // var items = []; //["华东勘测设计研究院",["部门1", "部门2", "部门3"]];
      // if(items && items.length>0){
      //     for(i = 0;i<items.length;i++){
      //
      //       html += `<li class="mui-table-view-cell" style="margin-left: 20px;line-height: 20px;padding-top: 12px;background-color: #FFFFFF;">
      //
      //                         <div class="mui-slider-handle">
      //                             <div class="nodeNo">${i+1}</div>
      //                             <div  class="select-query-list-title" style="width: 80%; display: inline-block;">
      //                                 <div class="spanLim">${items[i].text}</div>
      //                             </div>
      //                         </div>
      //                     </li>`
      //     }
      // }else{
      //     html +=`<div class='empty'>暂无数据js add</div>`;
      // }
      // $("#OA_task_1").html(html);


    });
    //  打电话
    $("#phone-blue-icon").on('tap', function() {
      //console.log('打电话')
      var btnArray=['拨打','取消'];
      var phone= $("#mobile").text(); //"13122222222";
      mui.confirm('是否拨打'+phone+'?','提示',btnArray,function(e){
        if(e.index == 0){
          plus.device.dial(phone,false);
        }
      });
    });

    mui("#content-ul").on('tap','.node-item',function(event){
      event.stopPropagation();

      var imgObj = event.target.previousElementSibling;
      console.log(imgObj);
      // if(imgObj.alt == 1) {
      //   imgObj.alt = 0;
      // }else{
      //   imgObj.alt = 1;
      // }
      // if(imgObj.alt == 1) {
      //   imgObj.src = "../../../img/starSelected.png"
      // }else{
      //   imgObj.src = "../../../img/starNormal.png"
      // }
    })

    // node-item-text
    mui("#content-ul").on('tap','.node-item-text',function(event){
      event.stopPropagation();

      //var imgObj = event.target.previousElementSibling;
     console.log(event);
      // if(imgObj.alt == 1) {
      //   imgObj.alt = 0;
      // }else{
      //   imgObj.alt = 1;
      // }
      // if(imgObj.alt == 1) {
      //   imgObj.src = "../../../img/starSelected.png"
      // }else{
      //   imgObj.src = "../../../img/starNormal.png"
      // }
    })

    // 请求数据
    function getAddressBookDetailFun(append){

      console.log("进入function getAddressBookDetail")
      getAddressBookDetail(param, function(data) {
        console.log("getAddressBookDetail 返回数据 ========== ")
        // console.log(JSON.stringify(data.result))
        if (data.success) {
          // addData(data.result.records);
          addData(data);
        } else {
          app.toast("通讯录明细查询失败")
        }
      });

    }

    // methods
    var initDestoryData = function(data, callback){
        for(let key in data){
            if(data[key] == '' || data[key] == null){
                data[key] = '暂无'
            }
        }
        callback(data);
    }

    function getRiver(riverName) {
        getRiverDirectories(riverName, riverPageNo, riverPageNo, function(data){
            riverData = data.result.records;
            let str0 = '';
            let str1 = '';
            let str2 = '';
            if(riverData != null && riverData.length != 0){
                let dataLength = riverData[0].childLevel.length
                initDestoryData(riverData[0], function(Data){
                    str0 =
                        `<div class="mui-row" style="text-align: left;">
								<div class="mui-col-sm-4 mui-col-xs-4">
									<span class="mui-table-view-cell">${riverName}</span>
								</div>
								<div class="mui-col-sm-4 mui-col-xs-4">
									<span class="mui-table-view-cell">${Data.riverLevelText}</span>
								</div>
								<div class="mui-col-sm-4 mui-col-xs-4">
									<span class="mui-table-view-cell">${Data.superRiver}</span>
								</div>
							</div>`;
                    str1 =
                        `<div id="highest" class="mui-row" style="font-weight: bold;border-top: 5px solid #F4F4F4;">
									<div class="mui-col-sm-6 mui-col-xs-6" style="padding: 0 20px;text-align: left;">
										<span class="mui-table-view-cell">河长职务</span>
									</div>
									<div class="mui-col-sm-6 mui-col-xs-6" style="padding: 0 20px;text-align: right;">
										<span class="mui-table-view-cell">${Data.personDuty}</span>
									</div>
								</div>

								<div id="details" style="border-top: 1px solid #F4F4F4;padding-top: 10px;">
									<div class="mui-row" style="">
										<div class="mui-col-sm-6 mui-col-xs-6"style="text-align: left;">
											<div style="padding: 0; height: 30px; line-height: 30px;">河长级别：${Data.levelDicText}</div>
											<div style="padding: 0; height: 30px; line-height: 30px; white-space: nowrap;">河长电话：${Data.personPhone}</div>
										</div>
										<div class="mui-col-sm-6 mui-col-xs-6" style="text-align: left;padding-left: 30px;">
											<div style="padding: 0; height: 30px; line-height: 30px;">河长姓名：${Data.personName}</div>
										</div>
									</div>
								</div>`;
                })


                for (let i = 0; i < dataLength; i++) {
                    initDestoryData(riverData[0].childLevel[i], function(Data){
                        str2 +=
                            `<li id="streetInfo" style="background-color: #FFFFFF;	border-top: 5px solid #F4F4F4;">
										<div id="leader" class="mui-row" style="font-weight: bold;">
											<div class="mui-col-sm-6 mui-col-xs-6"style="text-align: left;padding: 0 20px;">
												<span class="mui-table-view-cell">河长职务</span>
											</div>
											<div class="mui-col-sm-6 mui-col-xs-6" style="text-align: right;padding: 0 20px;">
												<span class="mui-table-view-cell">${Data.personDuty}</span>
											</div>
										</div>

										<div id="details" style="border-top: 1px solid #F4F4F4;padding-top: 10px;">
											<div class="mui-row" style="">
												<div class="mui-col-sm-6 mui-col-xs-6"style="text-align: left;">
													<div style="padding: 0; height: 30px; line-height: 30px;">所属街道：${Data.streetName}</div>
													<div style="padding: 0; height: 30px; line-height: 30px;">河长级别：${Data.levelDicText}</div>
													<div style="padding: 0; height: 30px; line-height: 30px; white-space: nowrap;">河长电话：${Data.personPhone}</div>
												</div>
												<div class="mui-col-sm-6 mui-col-xs-6" style="text-align: left;padding-left: 30px;">
													<div style="padding: 0; height: 30px; line-height: 30px;">所属社区：${Data.communityName}</div>
													<div style="padding: 0; height: 30px; line-height: 30px;">河长姓名：${Data.personName}</div>
												</div>
											</div>
										</div>
									</li>`
                    })

                }
                $('#whichRiver').html(str0);
                $('#districtInfo').html(str1);
                $('#streetDetail').html(str2);
                $("#viewMore").show();
                $("#riverOption").css("color","#337BFC")
                $('#streetDetail').hide();
                $('#viewMoreText').text("查看更多")
                $('#river_arrow_down').css("transform","rotate(0)")
            }else{
                $('#loadTips1').text("暂无数据！");
                $('#loadTips1').show();

                str0 =
                    `<div class="mui-row" style="text-align: left;">
							<div class="mui-col-sm-4 mui-col-xs-4">
								<span class="mui-table-view-cell">${riverName}</span>
							</div>
							<div class="mui-col-sm-4 mui-col-xs-4">
								<span class="mui-table-view-cell">${Data.riverLevelText}</span>
							</div>
							<div class="mui-col-sm-4 mui-col-xs-4">
								<span class="mui-table-view-cell">${Data.superRiver}</span>
							</div>
						</div>`;
                $('#whichRiver').html(str0);
                $('#districtInfo').html(str1);
                $('#streetDetail').html(str2);
                $("#viewMore").hide();
            }

        })


    }

    function getLake(lakeName) {
        getLakeDirectories(lakeName, lakePageNo, lakePageSize, function(data){
            lakeData = data.result.records;
            let str0 = '';
            let str1 = '';
            let str2 = '';
            if(lakeData.length != 0){
                let dataLength = lakeData[0].childLevel.length;
                initDestoryData(lakeData[0],function(Data){

                    str0 =
                        `<div class="mui-row" style="text-align: left;">
								<div class="mui-col-sm-4 mui-col-xs-4">
									<span class="mui-table-view-cell">${lakeName}</span>
								</div>
								<div class="mui-col-sm-4 mui-col-xs-4"></div>
								<div class="mui-col-sm-4 mui-col-xs-4"></div>
							</div>`;
                    str1 =
                        `<div id="leader" class="mui-row" style="font-weight: bold;	border-top: 5px solid #F4F4F4;">
									<div class="mui-col-sm-4 mui-col-xs-4" style="text-align: left;padding-left: 20px;">
										<span class="mui-table-view-cell">湖长职务</span>
									</div>
									<div class="mui-col-sm-8 mui-col-xs-8" style="text-align: right;padding-right: 20px;">
										<span class="mui-table-view-cell">${Data.personDuty}</span>
									</div>
								</div>

								<div id="details" style="border-top: 1px solid #F4F4F4;padding-top: 10px;">
									<div class="mui-row">
										<div class="mui-col-sm-6 mui-col-xs-6"style="text-align: left;">
											<div style="padding: 0; height: 30px; line-height: 30px;">湖长级别：${Data.levelDicText}</div>
											<div style="padding: 0; height: 30px; line-height: 30px; white-space: nowrap;">湖长电话：${Data.personPhone}</div>
										</div>
										<div class="mui-col-sm-6 mui-col-xs-6" style="text-align: left;padding-left: 30px;">
											<div style="padding: 0; height: 30px; line-height: 30px;">湖长姓名：${Data.personName}</div>
										</div>
									</div>
								</div>`;
                })
                for (let i = 0; i < dataLength; i++) {
                    initDestoryData(lakeData[0].childLevel[i], function(Data){
                        str2 +=`<li id="streetInfo" style="background-color: #FFFFFF;	border-top: 5px solid #F4F4F4;">
										<div id="leader" class="mui-row" style="font-weight: bold;">
											<div class="mui-col-sm-4 mui-col-xs-4" style="text-align: left; padding-left: 20px;">
												<span class="mui-table-view-cell">湖长职务</span>
											</div>
											<div class="mui-col-sm-8 mui-col-xs-8" style="text-align: right;padding-right: 20px;">
												<span class="mui-table-view-cell">${Data.personDuty}</span>
											</div>
										</div>

										<div id="details" style="border-top: 1px solid #F4F4F4;padding-top: 10px;">
											<div class="mui-row" style="">
												<div class="mui-col-sm-6 mui-col-xs-6"style="text-align: left;">
													<div style="padding: 0; height: 30px; line-height: 30px;">所属街道：${Data.streetName}</div>
													<div style="padding: 0; height: 30px; line-height: 30px;">湖长级别：${Data.levelDicText}</div>
													<div style="padding: 0; height: 30px; line-height: 30px; white-space: nowrap;">湖长电话：${Data.personPhone}</div>
												</div>
												<div class="mui-col-sm-6 mui-col-xs-6" style="text-align: left;padding-left: 30px;">
													<div style="padding: 0; height: 30px; line-height: 30px;">所属社区：${Data.communityName}</div>
													<div style="padding: 0; height: 30px; line-height: 30px;">湖长姓名：${Data.personName}</div>
												</div>
											</div>
										</div>
									</li>`
                    })

                }
                $('#whichLake').html(str0)
                $('#districtLakeInfo').html(str1);
                $('#streetLakeDetail').html(str2)
                $("#viewLakeMore").show();
                $("#lakeOption").css("color","#337BFC")
                $('#streetLakeDetail').hide();
                $('#viewLakeMoreText').text("查看更多")
                $('#lake_arrow_down').css("transform","rotate(0)")
            }else{
                console.log(lakeName)
                $('#loadTips2').text("暂无数据！");
                $('#loadTips2').show();
                str0 =
                    `<div class="mui-row" style="text-align: left;">
							<div class="mui-col-sm-4 mui-col-xs-4">
								<span class="mui-table-view-cell">${lakeName}</span>
							</div>
							<div class="mui-col-sm-4 mui-col-xs-4"></div>
							<div class="mui-col-sm-4 mui-col-xs-4"></div>
					</div>`;
                $('#whichLake').html(str0)
                $('#districtLakeInfo').html(str1);
                $('#streetLakeDetail').html(str2)
                $("#viewLakeMore").hide();
            }

        })
    }

    var initRiver = function(){
        let searchLength = searchRiver.length;
        if(searchLength != 0){
            let str = '';
            for (let i = 0; i < searchLength; i++) {
                initDestoryData(searchRiver[i], function(Data){
                    str +=`<li id="streetInfo" style="background-color: #FFFFFF;border-top: 5px solid #F4F4F4;">
									<div id="leader" class="mui-row" style="font-weight: bold;">
										<div class="mui-col-sm-6 mui-col-xs-6"style="text-align: left;padding: 0 20px;">
											<span class="mui-table-view-cell">河长职务</span>
										</div>
										<div class="mui-col-sm-6 mui-col-xs-6" style="text-align: right;padding: 0 20px;">
											<span class="mui-table-view-cell">${Data.personDuty}</span>
										</div>
									</div>

									<div id="details" style="border-top: 1px solid #F4F4F4;padding-top: 10px;">
										<div class="mui-row" style="">
											<div class="mui-col-sm-6 mui-col-xs-6"style="text-align: left;">
												<div style="padding: 0; height: 30px; line-height: 30px;">所属街道：${Data.streetName}</div>
												<div style="padding: 0; height: 30px; line-height: 30px;">河长级别：${Data.levelDicText}</div>
												<div style="padding: 0; height: 30px; line-height: 30px;">河长电话：${Data.personPhone}</div>
											</div>
											<div class="mui-col-sm-6 mui-col-xs-6" style="text-align: left;padding-left: 30px;">
												<div style="padding: 0; height: 30px; line-height: 30px;">所属社区：${Data.communityName}</div>
												<div style="padding: 0; height: 30px; line-height: 30px;">河长姓名：${Data.personName}</div>
											</div>
										</div>
									</div>
								</li>`
                })

            }
            $('#loadTips1').hide();
            $('#districtInfo').html(str);

        }else{
            $('#loadTips1').show();
            $('#loadTips1').text("暂无数据！");
            $('#districtInfo').empty();
            $("#viewMore").hide();
            $("#whichRiver").hide();
            $("#riverOption").css("color","#888888")
        }
    }

    var initSelected = function(){
        getRiverSelected(function(data){
            riverList = data.result.records;
            for(let i=0; i<riverList.length;i++){
                riverResultJSON[i] = {
                    text: riverList[i].riverName,
                    value: riverList[i].riverName
                }
            }
        })

        getLakeSelected(function(data){
            lakeList = data.result;
            for(let i=0; i<lakeList.length;i++){
                lakeResultJSON[i] = {
                    text:lakeList[i].name,
                    value: lakeList[i].name
                }
            }
        })
    }

    var initLake = function(){
        let searchLength = searchLake.length;
        if(searchLength != 0){
            let str = '';
            for (let i = 0; i < searchLength; i++) {
                initDestoryData(searchLake[i], function(Data){
                    str +=`<li id="streetInfo" style="background-color: #FFFFFF; border-top: 5px solid #F4F4F4;">
								<div id="leader" class="mui-row" style="font-weight: bold;">
									<div class="mui-col-sm-4 mui-col-xs-4" style="text-align: left; padding-left: 20px;">
										<span class="mui-table-view-cell">湖长职务</span>
									</div>
									<div class="mui-col-sm-8 mui-col-xs-8" style="text-align: right;padding-right: 20px;">
										<span class="mui-table-view-cell">${Data.personDuty}</span>
									</div>
								</div>

								<div id="details" style="border-top: 1px solid #F4F4F4;padding-top: 10px;">
									<div class="mui-row" style="">
										<div class="mui-col-sm-6 mui-col-xs-6"style="text-align: left;">
											<div style="padding: 0; height: 30px; line-height: 30px;">所属街道：${Data.streetName}</div>
											<div style="padding: 0; height: 30px; line-height: 30px;">湖长级别：${Data.levelDicText}</div>
											<div style="padding: 0; height: 30px; line-height: 30px;">湖长电话：${Data.personPhone}</div>
										</div>
										<div class="mui-col-sm-6 mui-col-xs-6" style="text-align: left;padding-left: 30px;">
											<div style="padding: 0; height: 30px; line-hegsht: 30px;">所属社区：${Data.communityName}</div>
											<div style="padding: 0; height: 30px; line-height: 30px;">湖长姓名：${Data.personName}</div>
										</div>
									</div>
								</div>
							</li>`
                })

            }
            $('#loadTips2').hide();
            $('#districtLakeInfo').html(str);
        }else{
            $('#loadTips2').show();
            $('#loadTips2').text("暂无数据！");
            $('#districtLakeInfo').empty();
            $("#viewLakeMore").hide();
            $("#whichLake").hide();
            $("#lakeOption").css("color","#888888")
        }
    }


    // JQ
    $('#search_input1').change(function(){
        if( $('#search_input1').val() != ''){
            $("#del_icon1").show();
            fuzzySearch(riverPageNo, riverPageSize, $('#search_input1').val(), 1, function(data) {
                searchRiver = data.result.records;
                initRiver();
                $("#whichRiver").hide();
                $("#streetDetail").hide();
                $("#viewMore").hide();
                $("#riverOption").css("color","#888888")
            })
        }else{
            app.toast("检索内容为空！")
            $('#del_icon1').hide();
        }
    })

    $('#search_input2').change(function(){
        if( $('#search_input2').val() != ''){
            $("#del_icon2").show();
            fuzzySearch(lakePageNo, lakePageSize, $('#search_input2').val(), 2, function(data) {
                searchLake = data.result.records;
                initLake();
                $("#whichLake").hide();
                $("#streetLakeDetail").hide();
                $("#viewLakeMore").hide();
                $("#lakeOption").css("color","#888888")
            })
        }else{
            app.toast("检索内容为空！")
            $('#del_icon2').hide();
        }
    })

    $('#search_input3').change(function(){
        if( $('#search_input3').val() != ''){
            $("#del_icon3").show();
            fuzzySearch(lakePageNo, lakePageSize, $('#search_input3').val(), 2, function(data) {
                searchLake = data.result.records;
                initLake();
                $("#whichLake").hide();
                $("#streetLakeDetail").hide();
                $("#viewLakeMore").hide();
                $("#lakeOption").css("color","#888888")
            })
        }else{
            app.toast("检索内容为空！")
            $('#del_icon3').hide();
        }
    })

    $('#search_input1').on('input',function(){
        if($("#search_input1").val() != ''){
            $("#del_icon1").show();
        }else{
            $("#del_icon1").hide();
        }
    })

    $('#search_input2').on('input',function(){
        if($("#search_input2").val() != ''){
            $("#del_icon2").show();
        }else{
            $("#del_icon2").hide();
        }
    })

    $('#search_input3').on('input',function(){
        if($("#search_input3").val() != ''){
            $("#del_icon3").show();
        }else{
            $("#del_icon3").hide();
        }
    })

    $("#del_icon1").on('tap', function(){
        $('#search_input1').val('');
        $("#del_icon1").hide();
        app.toast("检索内容为空！")
    })

    $("#del_icon2").on('tap', function(){
        $('#search_input2').val('');
        $("#del_icon2").hide();
        app.toast("检索内容为空！")
    })

    $("#del_icon3").on('tap', function(){
        $('#search_input3').val('');
        $("#del_icon3").hide();
        app.toast("检索内容为空！")
    })

    $('#item1').on('tap', function() {
        // getDirectories('river',riverPageNo,riverPageSize);
        input2.blur();
        input3.blur();
    })

    $('#item2').on('tap', function() {
        // getDirectories('lake',lakePageNo,lakePageSize);
        input1.blur();
        input3.blur();
    })
    $('#item3').on('tap', function() {
        // getDirectories('lake',lakePageNo,lakePageSize);
        input1.blur();
        input2.blur();
    })


    $('#viewMore').on('tap', function() {
        isOpen = !isOpen;
        if (isOpen) {
            $('#streetDetail').show();
            $('#viewMoreText').text("收起")
            $('#river_arrow_down').css("transform","rotate(180deg)")
        } else {
            $('#streetDetail').hide();
            $('#viewMoreText').text("查看更多")
            $('#river_arrow_down').css("transform","rotate(0)")
        }
    })

    $('#viewLakeMore').on('tap', function() {
        isLakeOpen = !isLakeOpen;
        if (isLakeOpen) {
            $('#streetLakeDetail').show();
            $('#viewLakeMoreText').text("收起")
            $('#lake_arrow_down').css("transform","rotate(180deg)")
        } else {
            $('#streetLakeDetail').hide();
            $('#viewLakeMoreText').text("查看更多")
            $('#lake_arrow_down').css("transform","rotate(0)")
        }
    })

    $("#missionUncompleted").on('tap', function() {
        isShow = true;
        $('#home-item').hide();
        mask.close();
    })

    $("#notification").on('tap', function() {
        app.openPage('', {
            titleNView: {
                titleText: '通知公告',
                autoBackButton: true
            }
        },extras);
    })

    $("#paishui").on('tap', function() {
        app.openPage('', {
            titleNView: {
                titleText: '通讯录',
                autoBackButton: true
            }
        },extras);
    })

    $('#riverSelect').on('tap', function(){

        if($(".mui-poppicker").hasClass("mui-active")){
            userPicker.hide();
            return false;
        }else{
            userPicker.setData(riverResultJSON);
            userPicker.show(function(items) {
                if(items[0].value !== null){
                    getRiver(items[0].value);
                    $('#loadTips1').hide();
                    $('#whichRiver').show();
                }
            })
        }


    })

    $('#lakeSelect').on('tap', function(){
        if($(".mui-poppicker").hasClass("mui-active")){
            userPicker.hide();
            return false;
        }else{
            userPicker.setData(lakeResultJSON);
            userPicker.show(function(items) {
                if(items[0].value !== null){
                    console.log(items[0].value)
                    getLake(items[0].value);
                    $('#loadTips2').hide();
                    $('#whichLake').show();
                }
            })
        }
    })

    //关闭遮罩层
    $(document).on("click", ".mui-backdrop", function() {
        isShow = true;
        $('#home-item').hide();
        mask.close();
    })

    window.addEventListener('backInspection', function(e) { //执行刷新
        // location.reload();
        // getDirectories('river',riverPageNo,riverPageSize);
        mui('#scroll1').scroll().scrollTo(0, 0, 0);
        mui('#contentList').scroll().scrollTo(0, 0, 0);
    });

    (function($) {
        $('.mui-scroll-wrapper').scroll({
            indicators: true //是否显示滚动条
        });
    })(mui);
    // $('.mui-scroll-wrapper').scroll( function(ev){
    // 	var oEvent = ev || event;
    // 	oEvent.stopImmediatePropagation();
    // });


  function  addData(paramData) {
    // console.log(JSON.stringify(paramData.result))
    var imgId = "";
    if(paramData.result != null && paramData.result != undefined) {


     // if(data.result.records != null && data.result.records != undefined && data.result.records.length > 0) {
        var dataObj = paramData.result;
        if(isTest) {
          dataObj = paramData.result.records[0]
        }

      //console.log(JSON.stringify(paramData.result))

      imgId = dataObj.personPhotoId;
        if(dataObj != null && dataObj != undefined) {

          var personNameStr = "";
          var personNameNull = dataObj.personName + "";
          if(personNameNull != undefined && personNameNull != null && personNameNull != "null") {
            personNameStr = dataObj.personName;
          }
          $('#person-name').text(personNameStr);

          var phoneStr = "未填写";
          var phoneNull = dataObj.personMobilePhone + "";
          if(phoneNull != undefined && phoneNull != null && phoneNull != "null") {
            phoneStr = dataObj.personMobilePhone;
          }

          $('#mobile').text(phoneStr);
          // 座机
          var telStr = "未填写";
          var telHomeNull = dataObj.personHomePhone + "";
          if(telHomeNull != undefined && telHomeNull != null && telHomeNull != "null") {
            telStr = dataObj.personHomePhone;
          }
          $('#tel').text(telStr);
          // email
          var emailStr = "";
          var emailNull = dataObj.personEmail + "";
          if(emailNull != undefined && emailNull != null && emailNull != "null") {
            emailStr = dataObj.personEmail;
          }
          $('#email').text(emailStr);

          // department
          var companyAndDepartStr = dataObj.companyName
          var companyAndDepartNull = dataObj.departName + ""
          if(companyAndDepartNull != undefined && companyAndDepartNull != null && companyAndDepartNull != "null") {
            companyAndDepartStr = dataObj.companyName + dataObj.departName;
          }

          $('#department').text(companyAndDepartStr);
        }
      }

    if(imgId != undefined && (imgId + "") != "" && (imgId + "") != "null") {
      // 加载图片
      console.log("imgId : " + imgId);
      findFilesByGroupIdAddrBook({
        groupId: imgId
      }, function(data) {
        console.log("img data : " + JSON.stringify(data));
        if(data.success){
          if(data.result.length> 0){
            $("#person-photo").html("");
            var html = "<img class='person-img-item'  src='" + config.urls.baseUrl +
                    "sys/common/view/" +
                    data.result[0].uploadFile.savePath + "' >";
            $("#person-photo").html(html);
            // console.log(html)
          }
        }
      });
    }


   // }

  }


  function tmpdata() {
    var dataStr = "{\"success\":true,\"message\":\"操作成功!\",\"result\":{\"records\":[{\"personTitle\":null,\"specialty\":\"\",\"companyName\":\"中国电建集团华东勘测设计研究院有限公司\",\"activitiSync\":1,\"personSex\":1,\"employmentStatus\":\"\",\"experience\":\"\",\"personZipCode\":null,\"dormantTime\":null,\"corpCode\":\"A01\",\"prjCode\":null,\"uuid\":null,\"personCode\":\"202102241041\",\"personRemark\":null,\"password\":null,\"personIndex\":null,\"corporationAddress\":\"浙江省杭州市潮王路22号 \",\"id\":\"18f885995250db94333d79dd095eebcf\",\"adminFlag\":0,\"departName\":\"华东数字\",\"personHealth\":\"\",\"companyCode\":null,\"isExpert\":0,\"personStudyProfession\":null,\"personAddress\":null,\"personIdentity\":null,\"personDuty\":null,\"personDepartmentId\":\"100000060003\",\"personQualification\":\"1\",\"roleListStr\":null,\"personPhotoId\":\"35c9c678ce1b4e158d7399288d6d33bd\",\"companyId\":\"100000060\",\"attachmentAutograph\":\"06f36b2d69214e128cf3efd472ca1c83\",\"personJobYear\":0,\"phone\":null,\"personPositional\":null,\"status\":1,\"perId\":\"5d653109c658cfb2939b760c655e970b\",\"personState\":null,\"tempFlag\":0,\"freezeTime\":null,\"personMobilePhone\":\"18576478118\",\"delFlag\":0,\"personHomePhone\":null,\"personInstitution\":null,\"updateBy\":\"A01admin\",\"orgCode\":null,\"personType\":null,\"addAccount\":null,\"personNation\":0,\"salt\":null,\"addToExpertTank\":null,\"personCompanyPhone\":null,\"updateTime\":\"2021-03-19 10:57:46\",\"avatar\":null,\"personBirth\":null,\"realname\":\"罗彦波\",\"typeFlag\":null,\"personName\":\"罗彦波\",\"personJob\":null,\"createBy\":\"ji_yc\",\"roleIds\":null,\"createTime\":\"2021-02-24 10:41:17\",\"personEmail\":\"luoyanbo@chinahd.com\",\"departCode\":null,\"expertType\":\"\",\"username\":\"luo_yb\"}],\"total\":1,\"size\":10,\"current\":1,\"searchCount\":true,\"pages\":1},\"timestamp\":1618366523112,\"code\":200}";
    var data = JSON.parse(dataStr);
    addData(data);
  }
  if(isTest) {
    tmpdata();
  }

    //tmpdata();
</script>

</html>
